(($,i,e,o)=>{'use strict';let c=!1,n=null,h=!0,t=!0,u=!1,r=null;const d=Object.assign({speed:0,element:'module_row',offset:null,navigation:'#main-nav,.module-menu .nav',updateHash:!0},tbLocalScript.scrollHighlight),g=parseInt(d.offset),f=e.top,m=o.getElementById('headerwrap'),s={init(e){if(h=null!==m&&i.body[0].classList.contains('fixed-header-enabled')||0<g,!1===u){const l=f.location.hash.replace('#','');if(l&&'#'!==l){let t=b(o.querySelectorAll('.'+d.element+'[data-anchor="'+l+'"]'));if(!t){let e=o.querySelector('.module [data-id="'+l+'"]');e&&(t=e.closest('.module'))}t&&this.scrollTo(t,l)}u=!0}this.createObserver(e)},changeHash(){if(!1===c){const n=f.location.hash.replace('#',''),a=o.querySelectorAll(d.navigation);for(let e=a.length-1;-1<e;--e){let l=a[e].getElementsByClassName('current-menu-item');for(let e=l.length-1;-1<e;--e)null===r&&(r=l[e].getElementsByTagName('a')[0].getAttribute('href')),l[e].classList.remove('current_page_item','current-menu-item');for(let t=(l=(l=''!==n&&'#'!==n?a[e].querySelectorAll('a[href*="#'+n+'"]'):null)&&0!==l.length?l:a[e].querySelectorAll('a[href="'+r+'"]')).length-1;-1<t;--t){let e=l[t].parentNode;e.classList.add('current-menu-item'),e.classList.contains('menu-item-object-page')&&e.classList.add('current_page_item')}}null===r&&(r=f.location.href.split('#')[0])}},calculatePosition(e){let t=$(e).offset().top+2;if(!0===h)if(g)t-=g-2;else if(m.classList.contains('fixed-header')){const l=m.getBoundingClientRect().bottom+2;t>=l&&(t-=l)}return t},scrollTo(e,a){c=!0,i.lazyScroll(i.convert(i.selectWithParent('[data-lazy]',e)).reverse(),!0);const r=i.lazyScrolling,s=!1===u,t=()=>{const t=p(),l=o.getElementsByClassName(d.element),n=new IntersectionObserver((t,e)=>{for(let e=t.length-1;-1<e;--e)!0===t[e].isIntersecting&&i.lazyScroll(i.convert(i.selectWithParent('[data-lazy]',t[e].target)).reverse(),!0);e.disconnect()},{rootMargin:'300px 0px 300px 0px',threshold:.01});for(let e=l.length-1;-1<e;--e)l[e].hasAttribute('data-lazy')&&!l[e].classList.contains('hide-'+t)&&n.observe(l[e]);!0===h&&(g||m.classList.contains('fixed-header'))&&i.scrollTo(this.calculatePosition(e),d.speed),i.lazyScrolling=r,(c=!1)===s&&(a=e.hasAttribute('data-hide-anchor')?'':'#'+a.replace('#',''),f.history.replaceState(null,null,a)),y()},l=!0!==h||!g&&m.classList.contains('fixed-header')?null:()=>{(g||m.classList.contains('fixed-header'))&&i.scrollTo(this.calculatePosition(e),d.speed,t)};i.lazyScrolling=!0,i.scrollTo(this.calculatePosition(e),d.speed,t,l),o.activeElement.blur()},createObserver(e){if(d.updateHash){null===n&&(n=new IntersectionObserver((n,e)=>{if(!1===c){let l=!1;for(let e=0,t=n.length;e<t;++e)!0===n[e].isIntersecting&&(l=n[e].target.getAttribute('data-anchor'));!1===l?!1===t?(f.history.replaceState(null,null,' '),y()):t=!1:(f.history.replaceState(null,null,'#'+l),y())}},{rootMargin:'0px 0px -100%',thresholds:[0,1]}));const l=i.selectWithParent(d.element,e);for(let t=l.length-1;-1<t;--t)if(!l[t].hasAttribute('data-hide-anchor')){let e=l[t].getAttribute('data-anchor');e&&'#'!==e&&n.observe(l[t])}}}},p=()=>{const t=i.w,l=tbLocalScript.breakpoints;for(let e in l)if(Array.isArray(l[e])){if(t>=l[e][0]&&t<=l[e][1])return e}else if(t<=l[e])return e;return'desktop'},b=l=>{if(!l[1])return l[0]||null;let n=p();for(let e=0,t=l.length;e<t;++e)if(!l[e].classList.contains('hide-'+n))return l[e];return null},y=()=>{s.changeHash()};i.on('tb_scroll_highlight_enable',()=>{f.addEventListener('hashchange',y,{passive:!0}),i.body.on('click.tb_scroll_highlight','[href*="#"]',function(e){let t=this.getAttribute('href');if(''!==t&&null!==t&&'#'!==t){const l=new URL(t,f.location);if(l.hostname===f.location.hostname&&l.hash&&l.pathname===f.location.pathname){const n=l.hash;if(''!==n&&'#'!==n){const a=b(o.querySelectorAll('.'+d.element+'[data-anchor="'+n.replace('#','')+'"]'));(a||b(o.querySelectorAll(n+'.module,'+n+'.module_row')))&&(i.trigger('tf_side_menu_hide_all'),a&&(e.preventDefault(),e.stopPropagation(),s.scrollTo(a,n)))}}}})}).on('tb_scroll_highlight_disable',()=>{n&&(n.disconnect(),n=null),f.removeEventListener('hashchange',y,{passive:!0}),i.body.off('click.tb_scroll_highlight')}).on('tb_init_scroll_highlight',e=>{s.init(e),i.trigger('tb_scroll_highlight_enable')})})(jQuery,Themify,window,document);