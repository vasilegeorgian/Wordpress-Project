((s,d)=>{'use strict';let i,o,n=!1,f=s.w,m=s.h,t=!1;const b=new Map,e='m'===tbLocalScript.is_sticky&&parseInt(tbLocalScript.breakpoints.tablet[1]),l=function(t,e){i&&cancelAnimationFrame(i),!0!==n&&(i=requestAnimationFrame(()=>{const s=d.pageYOffset,t=e||b;for(let e of t){let o=e[0],n=e[1],t=o.classList.contains('tb_sticky_scroll_active');if('disable'!==n)if(!0===n.isBottom&&s+m>=n.space||!0!==n.isBottom&&s>n.space){if(!1===t&&(o.style.width=n.w+'px',o.parentNode.style.height=n.h+'px',o.style.position='fixed',o.style.top=n.value,o.classList.add('tb_sticky_scroll_active')),n.unstick&&n.unstick.item){let t=n.unstick,e=parseInt(n.value),s=t.item.getBoundingClientRect(),i;'builder'===t.type?i=s.bottom-n.h-e:(i='passes'===t.r?s.bottom-e:s.top-n.h-e,'top'!==t.cur&&'bottom'!==t.cur||(i+=t.v,'bottom'===t.cur&&(i-=m))),i=i<0?i+e+'px':n.value,n.currentTop!==i&&(n.currentTop=i,b.set(o,n),o.style.top=i)}}else!0===t&&h(o)}}))},h=t=>{t.style.width=t.style.top=t.style.bottom=t.style.position=t.parentNode.style.height='',t.classList.remove('tb_sticky_scroll_active')},a=new MutationObserver(e=>{if(e[0]){let t=e[0].target.closest('[data-sticky-active]');t&&(o&&cancelAnimationFrame(o),o=requestAnimationFrame(()=>{s.imagesLoad(t,t=>{const e=new Map;h(t),c(t),e.set(t,b.get(t)),l(0,e),o=null})}))}}),c=(i,e,t)=>{const s=i.classList.contains('tb_sticky_scroll_active');if(!1===s||!0===t){if(!b.has(i)||!0===t){const n=(i=>{let o=!1;const n=tbLocalScript.breakpoints,l=Object.keys(n);for(let t=l.length-1;-1<t;--t){let e=l[t],s='tablet_landscape'===e?'tl':e[0];if(void 0!==i[s]){let t='mobile'!==e?n[e][1]:n[e];if(t>=f){o=i[s];break}}}return o=!1===o?i.d:o})(JSON.parse(i.getAttribute('data-sticky-active')));if(!n)return b.set(i,'disable'),void h(i);const l=n.stick||{},a=l.v?parseInt(l.v):0,c=n.unstick,r=l.u||'px';if('px'!==r?n.u=r:n.value=a+r,n.v=a,'bottom'===l.p&&(n.isBottom=!0),c){let e,s=i.closest('.themify_builder_content');if('builder'===c.type){let t=s.closest('#tbp_header');(t=t&&(null!==(t=document.getElementById('tbp_content'))?t.getElementsByClassName('themify_builder_content')[0]:document.getElementsByClassName('themify_builder_content')[1]))&&(s=t),e=s}else(e=(e='row'===c.type?s.getElementsByClassName('tb_'+c.el)[0]:e)||s.getElementsByClassName('tb_'+c.el)[0])&&(c.v=parseInt(c.v));e&&(c.item=e)}if(!i.parentNode.classList.contains('tb_sticky_wrapper')){const p=document.createElement('div');p.className='tb_sticky_wrapper',i.parentNode.insertBefore(p,i),p.appendChild(i)}b.set(i,n)}const o=b.get(i);if('disable'!==o){!0===s&&(i.style.position=''),e||(i.style.width='',e=i.getBoundingClientRect()),o.w=0<e.width?e.width:i.offsetWidth,o.h=0<e.height?e.height:i.offsetHeight;let t=o.v;'%'===o.u&&0!==t&&(t=t/100*m),!0===o.isBottom&&(t=m-t-o.h),o.value=t+'px',o.space=void 0!==o.isBottom?e.bottom+d.pageYOffset+t:e.top+d.pageYOffset-t,o.t=e.top,i.parentNode.style.height!==o.h+'px'&&(i.parentNode.style.height=o.h+'px'),!0===s&&(i.style.position='fixed'),b.set(i,o)}}},r=new IntersectionObserver((e,t)=>{for(let t=e.length-1;-1<t;--t)!0===e[t].isIntersecting&&c(e[t].target,e[t].boundingClientRect)},{threshold:[.3,.4,.5,.6,.7,.8,.9,1]});s.on('tb_sticky_init',e=>{for(let t=(e=e instanceof jQuery?e.get():e).length-1;-1<t;--t)r.observe(e[t]),a.observe(e[t],{subtree:!0,childList:!0});if(!1===t){if(t=!0,0<d.pageYOffset){for(let t=e.length-1;-1<t;--t)c(e[t],e[t].getBoundingClientRect());l()}d.addEventListener('scroll',l,{passive:!0})}}).on('tfsmartresize',t=>{if(t){f=t.w,m=t.h,n=!!(e&&e>=f);for(let t of b)!0===n?h(t[0]):c(t[0],null,!0);!1===n&&l()}})})(Themify,window);