(($,b,u)=>{'use strict';var e,r,n,a,d=jQuery,o=window;d.fn.tb_backstretch=function(i,s){return void 0!==s&&(void 0===s.mode&&(void 0!==o.themifyScript&&o.themifyScript.backgroundMode?s.mode=themifyScript.backgroundMode:void 0!==o.themifyVars&&o.themifyVars.backgroundMode&&(s.mode=themifyVars.backgroundMode)),void 0===s.position&&(void 0!==o.themifyScript&&o.themifyScript.backgroundPosition&&o.themifyScript.backgroundPosition?s.position=o.themifyScript.backgroundPosition:void 0!==o.themifyVars&&o.themifyVars.backgroundPosition&&o.themifyVars.backgroundPosition&&(s.position=o.themifyVars.backgroundPosition)),void 0===s.is_first&&(s.is_first=!0)),i!==e&&0!==i.length||d.error("No images were supplied for Backstretch"),0===d(o).scrollTop()&&o.scrollTo(0,0),this.each(function(){var t=d(this),e=t.data("tb_backstretch");if(e){if("string"==typeof i&&"function"==typeof e[i])return void e[i](s);s=d.extend(e.options,s),e.destroy(!0)}e=new a(this,i,s),t.data("tb_backstretch",e)})},d.tb_backstretch=function(t,e){return d("body").tb_backstretch(t,e).data("tb_backstretch")},d.expr.pseudos.tb_backstretch=function(t){return d(t).data("tb_backstretch")!==e},d.fn.tb_backstretch.defaults={centeredX:!0,centeredY:!0,duration:5e3,fade:0,mode:"",position:""},r={left:0,top:0,overflow:"hidden",margin:0,padding:0,height:"100%",width:"100%",zIndex:-999999},n={position:"absolute",display:"none",margin:0,padding:0,border:"none",width:"auto",height:"auto",maxHeight:"none",maxWidth:"none",zIndex:-999999},(a=function(t,e,i){for(var s in this.options=d.extend({},d.fn.tb_backstretch.defaults,i||{}),this.images=d.isArray(e)?e:[e],this.images)d("<img />")[0].src=void 0===this.images[s].url?this.images[s]:this.images[s].url;this.isBody=t===document.body,this.$container=d(t),this.$root=this.isBody?d(o):this.$container,t=this.$container.children(".tb_backstretch").first(),this.$wrap=t.length?t:d("<div class=\"tb_backstretch\"></div>").css(r).appendTo(this.$container),this.isBody||(t=this.$container.css("position"),e=this.$container.css("zIndex"),this.$container.css({position:"static"===t?"relative":t,zIndex:"auto"===e?0:e,backgroundImage:"none"}),this.$wrap.css({zIndex:-999998})),this.$wrap.css({position:this.isBody?"fixed":"absolute"}),this.index=0,this.show(this.index,this.options.is_first),d(o).on("resize.tb_backstretch",d.proxy(this.resize,this)).on("orientationchange.tb_backstretch",d.proxy(function(){this.isBody&&0===o.pageYOffset&&(o.scrollTo(0,1),this.resize())},this))}).prototype={resize(){try{var t,e={left:0,top:0},i=this.isBody?this.$root.width():this.$root.innerWidth(),s=i,r=this.isBody?o.innerHeight||this.$root.height():this.$root.innerHeight(),a=s/this.$img.data("ratio");"best-fit"===this.options.mode&&(s/r>parseFloat(this.$img.data("ratio"))?this.$img.addClass("best-fit-vertical").removeClass("best-fit-horizontal"):this.$img.addClass("best-fit-horizontal").removeClass("best-fit-vertical")),r<=a?(t=(a-r)/2,this.options.centeredY&&(e.top="-"+t+"px")):(t=((s=(a=r)*this.$img.data("ratio"))-i)/2,this.options.centeredX&&(e.left="-"+t+"px")),this.$wrap.css({width:i,height:r}).find("img:not(.deleteable)").css({width:s,height:a}).css(e)}catch(t){}return this},show(i,s){var t,r,a,o;if(!(Math.abs(i)>this.images.length-1))return a=(r=this).$wrap.find("img").addClass("deleteable"),o={relatedTarget:r.$container[0]},r.$container.trigger(d.Event("tb_backstretch.before",o),[r,i]),this.index=i,clearInterval(r.interval),r.$img=d("<img />").css(n).bind("load",function(t){var e=this.width||d(t.target).width();t=this.height||d(t.target).height(),d(this).data("ratio",e/t),void 0!==r&&("best-fit"===r.options.mode?(d(this).parent().addClass("best-fit-wrap"),e=e/t,r.$wrap.width()/r.$wrap.height()>e?d(this).addClass("best-fit best-fit-vertical"):d(this).addClass("best-fit best-fit-horizontal")):"fullcover"===r.options.mode&&r.options.position?d(this).addClass("fullcover-"+r.options.position):"kenburns-effect"===r.options.mode&&d(this).parent().addClass("kenburns-effect"),s&&d(this).show()),d(this).fadeIn(r.options.speed||r.options.fade,function(){a.remove(),r.paused||r.cycle(),d(["after","show"]).each(function(){r.$container.trigger(d.Event("tb_backstretch."+this,o),[r,i])})}),r.resize()}).appendTo(r.$wrap),void 0===r.images[i].url?t=r.images[i]:(t=r.images[i].url,r.images[i].alt&&r.$img.attr("alt",r.images[i].alt)),r.$img.attr("src",t),r},next(){return this.show(this.index<this.images.length-1?this.index+1:0,!1)},prev(){return this.show(0===this.index?this.images.length-1:this.index-1,!1)},pause(){return this.paused=!0,this},resume(){return this.paused=!1,this.next(),this},cycle(){return 1<this.images.length&&(clearInterval(this.interval),this.interval=setInterval(d.proxy(function(){this.paused||this.next()},this),this.options.duration)),this},destroy(t){d(o).off("resize.tb_backstretch orientationchange.tb_backstretch"),clearInterval(this.interval),t||this.$wrap.remove(),this.$container.removeData("tb_backstretch")}},u.autoplay=u.backgroundSlider&&u.backgroundSlider.autoplay?parseInt(u.backgroundSlider.autoplay.autoplay,10):5e3;const h=d=>{u.autoplay<=10&&(u.autoplay*=1e3);for(let n=d.length-1;-1<n;--n){let t=$(d[n]),r=t.parent(),e=d[n].getElementsByTagName('li'),i=[];for(var h=e.length-1;-1<h;--h)i.push({url:e[h].getAttribute('data-bg'),alt:e[h].getAttribute('data-bg-alt')});r.tb_backstretch(i,{speed:parseInt(d[n].getAttribute('data-sliderspeed')),duration:u.autoplay,mode:d[n].getAttribute('data-bgmode')});let s=r.data('tb_backstretch'),a=t.find('.row-slider-slides > li'),o='row-slider-dot-active';for(h=(e=d[n].querySelectorAll('.row-slider-prev,.row-slider-next,.row-slider-dot')).length-1;-1<h;--h)e[h].addEventListener('click',function(t){this.classList.contains('row-slider-dot')?s.show($(this).data('index')):(t.preventDefault(),this.classList.contains('row-slider-prev')?s.prev():s.next())},{passive:e[h].classList.contains('row-slider-dot')});if(a[0]&&(a[0].classList.add(o),r.on('tb_backstretch.show',(t,e)=>{const i=a.eq(s.index);i[0]&&(a.removeClass(o),i.addClass(o))})),'kenburns-effect'===d[n].getAttribute('data-bgmode')){let s,t=0;const c=4<i.length?4:i.length,l=()=>t+1>c?t=1:++t;r.on('tb_backstretch.before',(t,e)=>{setTimeout(()=>{if(s!=e.index){const t=e.$wrap.find('img').last();t.addClass('kenburns-effect'+l()),s=e.index}},50)}).on('tb_backstretch.after',(t,e)=>{const i=e.$wrap.find('img').last();/kenburns-effect\d/.test(i.attr('class'))||(i.addClass('kenburns-effect'+l()),s=e.index)}),b.is_builder_active&&r.on('backstretch.show',(t,e,i)=>{r.css('zIndex',0)})}}};b.on('builder_load_module_partial',(t,e,i)=>{let s;if(!0===i){if('DIV'!==t[0].tagName||t[0].classList.contains('module'))return;const r=t[0].querySelector(':scope>.tb_slider');if(null===r)return;s=[r]}else s=b.selectWithParent('tb_slider',t);void 0!==s[0]&&(!0!==b.cssLazy.tb_bgslider_css?b.LoadCss(ThemifyBuilderModuleJs.cssUrl+'backgroundSlider.css',null,null,null,()=>{b.cssLazy.tb_bgslider_css=!0,h(s)}):h(s))})})(jQuery,Themify,tbLocalScript);