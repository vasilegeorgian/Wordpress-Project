!function($){'use strict';function d(t){const i=t.parent();t.removeData('tfminicolors-initialized').removeData('tfminicolors-settings').removeProp('size').removeClass('tfminicolors-input'),i.before(t).remove()}function f(t){var i=t.parent(),e=i.find('.tfminicolors-panel'),o=t.data('tfminicolors-settings'),s=document.body.contains(t[0])?document:top.document;!t.data('tfminicolors-initialized')||t.prop('disabled')||i.hasClass('tfminicolors-inline')||i.hasClass('tfminicolors-focus')||(p(window.top.document),i.addClass('tfminicolors-focus'),e.animate?e.stop(!0,!0).fadeIn(o.showSpeed,function(){o.show&&o.show.call(t.get(0))}):(e.show(),o.show&&o.show.call(t.get(0))),$(s).on('mousedown.tfminicolors touchstart.tfminicolors',function(t){1===t.which&&0===$(t.target).closest('.tfminicolors,.tfminicolors_wrapper').length&&($(this).off('mousemove.tfminicolors touchmove.tfminicolors mousedown.tfminicolors touchstart.tfminicolors mouseup.tfminicolors touchend.tfminicolors'),p(this))}))}function p(t){$('.tfminicolors-focus',t).each(function(){const t=$(this),i=t.find('.tfminicolors-input'),e=t.find('.tfminicolors-panel'),o=i.data('tfminicolors-settings');e.animate?e.fadeOut(o.hideSpeed,function(){o.hide&&o.hide.call(i.get(0)),t.removeClass('tfminicolors-focus')}):(e.hide(),o.hide&&o.hide.call(i.get(0)),t.removeClass('tfminicolors-focus'))})}function m(t,i,e){let o=t.parents('.tfminicolors').find('.tfminicolors-input'),s=o.data('tfminicolors-settings'),a=t.find('[class$=-picker]'),n=t.offset().left,r=t.offset().top,c=Math.round(i.pageX-n),l=Math.round(i.pageY-r),h=e?s.animationSpeed:0,d,f,p,m,u;i.originalEvent.changedTouches&&(c=i.originalEvent.changedTouches[0].pageX-n,l=i.originalEvent.changedTouches[0].pageY-r),c<0&&(c=0),l<0&&(l=0),c>t.width()&&(c=t.width()),l>t.height()&&(l=t.height()),t.parent().hasClass('tfminicolors-slider-wheel')&&a.parent().hasClass('tfminicolors-grid')&&(d=75-c,f=75-l,p=Math.sqrt(d*d+f*f),(m=Math.atan2(f,d))<0&&(m+=2*Math.PI),75<p&&(c=75-75*Math.cos(m),l=75-75*Math.sin(m)),c=Math.round(c),l=Math.round(l)),u={top:l+'px'},t.is('.tfminicolors-grid')&&(u.left=c+'px'),a.animate?a.stop(!0).animate(u,h,s.animationEasing,function(){g(o,t)}):(a.css(u),g(o,t))}function g(t,i){function e(t,i){return t.length&&i?{x:t.offset().left-i.offset().left+t.outerWidth()/2,y:t.offset().top-i.offset().top+t.outerHeight()/2}:null}let o,s,a,n,r,c,l,h=t.val(),d=t.attr('data-opacity'),f=t.parent(),p=t.data('tfminicolors-settings'),m=f.find('.tfminicolors-input-swatch'),u=f.find('.tfminicolors-grid'),g=f.find('.tfminicolors-slider'),w=f.find('.tfminicolors-opacity-slider'),b=u.find('[class$=-picker]'),y=g.find('[class$=-picker]'),C=w.find('[class$=-picker]'),v=e(b,u),k=e(y,g),_=e(C,w);if(i.is('.tfminicolors-grid, .tfminicolors-slider, .tfminicolors-opacity-slider')){switch(p.control){case'wheel':n=u.width()/2-v.x,r=u.height()/2-v.y,c=Math.sqrt(n*n+r*r),(l=Math.atan2(r,n))<0&&(l+=2*Math.PI),75<c&&(c=75,v.x=69-75*Math.cos(l),v.y=69-75*Math.sin(l)),s=I(c/.75,0,100),o=I(180*l/Math.PI,0,360),a=I(100-Math.floor(100*k.y/g.height()),0,100),h=T({h:o,s:s,b:a}),g.css('backgroundColor',T({h:o,s:s,b:100}));break;case'saturation':o=I(parseInt(360*v.x/u.width(),10),0,360),s=I(100-Math.floor(100*k.y/g.height()),0,100),a=I(100-Math.floor(100*v.y/u.height()),0,100),h=T({h:o,s:s,b:a}),g.css('backgroundColor',T({h:o,s:100,b:a})),f.find('.tfminicolors-grid-inner').css('opacity',s/100);break;case'brightness':o=I(parseInt(360*v.x/u.width(),10),0,360),s=I(100-Math.floor(100*v.y/u.height()),0,100),a=I(100-Math.floor(100*k.y/g.height()),0,100),h=T({h:o,s:s,b:a}),g.css('backgroundColor',T({h:o,s:s,b:100})),f.find('.tfminicolors-grid-inner').css('opacity',1-a/100);break;default:o=I(360-parseInt(360*k.y/g.height(),10),0,360),s=I(Math.floor(100*v.x/u.width()),0,100),a=I(100-Math.floor(100*v.y/u.height()),0,100),h=T({h:o,s:s,b:a}),u.css('backgroundColor',T({h:o,s:100,b:100}));break}d=p.opacity?parseFloat(1-_.y/w.height()).toFixed(2):1,S(t,h,d)}else m.find('span').css({backgroundColor:h,opacity:d}),M(t,h,d)}function S(t,i,e){let o,s=t.parent(),a=t.data('tfminicolors-settings'),n=s.find('.tfminicolors-input-swatch');a.opacity&&t.attr('data-opacity',e),i='rgb'===a.format?(o=D(i)?N(i,!0):O(x(i,!0)),e=''===t.attr('data-opacity')?1:I(parseFloat(t.attr('data-opacity')).toFixed(2),0,1),!isNaN(e)&&a.opacity||(e=1),t.tfminicolors('rgbObject').a<=1&&o&&a.opacity?'rgba('+o.r+', '+o.g+', '+o.b+', '+parseFloat(e)+')':'rgb('+o.r+', '+o.g+', '+o.b+')'):_(i=D(i)?F(i):i,a.letterCase),t.val(i),n.find('span').css({backgroundColor:i,opacity:e}),s.removeClass('tfminicolors-var-input'),M(t,i,e)}function u(t,i){let e,o,s,a,n,r,c,l;const h=t.parent(),d=t.data('tfminicolors-settings'),f=h.find('.tfminicolors-input-swatch'),p=h.find('.tfminicolors-grid'),m=h.find('.tfminicolors-slider'),u=h.find('.tfminicolors-opacity-slider'),g=p.find('[class$=-picker]'),w=m.find('[class$=-picker]'),b=u.find('[class$=-picker]'),y=t.val(),C=(D(y)?(e=F(y),(s=I(parseFloat(j(y)).toFixed(2),0,1))&&t.attr('data-opacity',s)):e=_(x(y,!0),d.letterCase),function(t){t=O(t),e={h:0,s:0,b:0},o=Math.min(t.r,t.g,t.b),s=Math.max(t.r,t.g,t.b),o=s-o,e.b=s,e.s=0!==s?255*o/s:0,0!==e.s?t.r===s?e.h=(t.g-t.b)/o:t.g===s?e.h=2+(t.b-t.r)/o:e.h=4+(t.r-t.g)/o:e.h=-1,e.h*=60,e.h<0&&(e.h+=360),e.s*=100/255,e.b*=100/255;const i=e;var e,o,s;return 0===i.s&&(i.h=360),i}(e=e||_(E(d.defaultValue,!0),d.letterCase))),v=d.keywords?$.map(d.keywords.split(','),function(t){return $.trim(t.toLowerCase())}):[],k=''!==y&&0===y.indexOf('--');switch(''!==y&&(1==k||-1<$.inArray(y.toLowerCase(),v))?(a=_(y),1==k&&h.addClass('tfminicolors-var-input')):(a=D(y)?N(y):e,h.removeClass('tfminicolors-var-input')),i||t.val(a),d.opacity&&(o=''===t.attr('data-opacity')?1:I(parseFloat(t.attr('data-opacity')).toFixed(2),0,1),isNaN(o)&&(o=1),t.attr('data-opacity',o),f.find('span').css('opacity',o),r=I(u.height()-u.height()*o,0,u.height()),b.css('top',r+'px')),'transparent'===y.toLowerCase()&&f.find('span').css('opacity',0),f.find('span').css('backgroundColor',e),d.control){case'wheel':c=I(Math.ceil(.75*C.s),0,p.height()/2),l=C.h*Math.PI/180,n=I(75-Math.cos(l)*c,0,p.width()),r=I(75-Math.sin(l)*c,0,p.height()),g.css({top:r+'px',left:n+'px'}),r=150-C.b/100*p.height(),''===e&&(r=0),w.css('top',r+'px'),m.css('backgroundColor',T({h:C.h,s:C.s,b:100}));break;case'saturation':n=I(5/12*C.h,0,150),r=I(p.height()-Math.ceil(C.b/100*p.height()),0,p.height()),g.css({top:r+'px',left:n+'px'}),r=I(m.height()-C.s*m.height()/100,0,m.height()),w.css('top',r+'px'),m.css('backgroundColor',T({h:C.h,s:100,b:C.b})),h.find('.tfminicolors-grid-inner').css('opacity',C.s/100);break;case'brightness':n=I(5/12*C.h,0,150),r=I(p.height()-Math.ceil(C.s/100*p.height()),0,p.height()),g.css({top:r+'px',left:n+'px'}),r=I(m.height()-C.b*m.height()/100,0,m.height()),w.css('top',r+'px'),m.css('backgroundColor',T({h:C.h,s:C.s,b:100})),h.find('.tfminicolors-grid-inner').css('opacity',1-C.b/100);break;default:n=I(Math.ceil(C.s/100*p.width()),0,p.width()),r=I(p.height()-Math.ceil(C.b/100*p.height()),0,p.height()),g.css({top:r+'px',left:n+'px'}),r=I(m.height()-C.h/360*m.height(),0,m.height()),w.css('top',r+'px'),p.css('backgroundColor',T({h:C.h,s:100,b:100}));break}t.data('tfminicolors-initialized')&&M(t,a,o)}function M(t,i,e){let o=t.data('tfminicolors-settings'),s=t.data('tfminicolors-lastChange'),a,n,r;if(!s||s.value!==i||s.opacity!==e){if(t.data('tfminicolors-lastChange',{value:i,opacity:e}),o.swatches&&0!==o.swatches.length){for(a=D(i)?N(i,!0):O(i),n=-1,r=0;r<o.swatches.length;++r)if(a.r===o.swatches[r].r&&a.g===o.swatches[r].g&&a.b===o.swatches[r].b&&a.a===o.swatches[r].a){n=r;break}t.parent().find('.tfminicolors-swatches .tfminicolors-swatch').removeClass('selected'),-1!==n&&t.parent().find('.tfminicolors-swatches .tfminicolors-swatch').eq(r).addClass('selected')}o.change&&(o.changeDelay?(clearTimeout(t.data('tfminicolors-changeTimeout')),t.data('tfminicolors-changeTimeout',setTimeout(function(){o.change.call(t.get(0),i,e)},o.changeDelay))):o.change.call(t.get(0),i,e)),t.trigger('change').trigger('input')}}function _(t,i){return'uppercase'===i?t.toUpperCase():t.toLowerCase()}function x(t,i){return!(t=t.replace(/^#/g,'')).match(/^[A-F0-9]{3,6}/gi)||3!==t.length&&6!==t.length?'':'#'+(t=3===t.length&&i?t[0]+t[0]+t[1]+t[1]+t[2]+t[2]:t)}function N(t,i){t=t.replace(/[^\d,.]/g,'').split(',');return t[0]=I(parseInt(t[0],10),0,255),t[1]=I(parseInt(t[1],10),0,255),t[2]=I(parseInt(t[2],10),0,255),void 0!==t[3]&&(t[3]=I(parseFloat(t[3],10),0,1)),i?void 0!==t[3]?{r:t[0],g:t[1],b:t[2],a:t[3]}:{r:t[0],g:t[1],b:t[2]}:void 0!==t[3]&&t[3]<=1?'rgba('+t[0]+', '+t[1]+', '+t[2]+', '+t[3]+')':'rgb('+t[0]+', '+t[1]+', '+t[2]+')'}function E(t,i){return D(t)?N(t):x(t,i)}function I(t,i,e){return t<i?t=i:e<t&&(t=e),t}function D(t){const i=t.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i);return i&&4===i.length}function j(t){return(t=t.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+(\.\d{1,2})?|\.\d{1,2})[\s+]?/i))&&6===t.length?t[4]:'1'}function F(t){return(t=t.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i))&&4===t.length?'#'+('0'+parseInt(t[1],10).toString(16)).slice(-2)+('0'+parseInt(t[2],10).toString(16)).slice(-2)+('0'+parseInt(t[3],10).toString(16)).slice(-2):''}function w(t){var e=[t.r.toString(16),t.g.toString(16),t.b.toString(16)];return $.each(e,function(t,i){1===i.length&&(e[t]='0'+i)}),'#'+e.join('')}function T(t){return w((t=t,e={},o=Math.round(t.h),s=Math.round(2.55*t.s),t=Math.round(2.55*t.b),0===s?e.r=e.g=e.b=t:(t=o%60*((i=t)-(s=(255-s)*t/255))/60,(o=360===o?0:o)<60?(e.r=i,e.b=s,e.g=s+t):o<120?(e.g=i,e.b=s,e.r=i-t):o<180?(e.g=i,e.r=s,e.b=s+t):o<240?(e.b=i,e.r=s,e.g=i-t):o<300?(e.b=i,e.g=s,e.r=s+t):o<360?(e.r=i,e.g=s,e.b=i-t):(e.r=0,e.g=0,e.b=0)),{r:Math.round(e.r),g:Math.round(e.g),b:Math.round(e.b)}));var i,e,o,s}function O(t){return{r:(t=parseInt(-1<t.indexOf('#')?t.substring(1):t,16))>>16,g:(65280&t)>>8,b:255&t}}$.tfminicolors={defaults:{animationSpeed:50,animationEasing:'swing',change:null,changeDelay:0,control:'hue',defaultValue:'',format:'hex',hide:null,hideSpeed:100,inline:!1,keywords:'',letterCase:'lowercase',opacity:!1,position:'bottom',show:null,showSpeed:100,theme:'default',swatches:[]}},$.extend($.fn,{tfminicolors:function(i,l){switch(i){case'destroy':return $(this).each(function(){d($(this))}),$(this);case'hide':return p(),$(this);case'opacity':return void 0===l?$(this).attr('data-opacity'):($(this).each(function(){u($(this).attr('data-opacity',l))}),$(this));case'rgbObject':{var e=$(this);const t=$(e),s=t.attr('data-opacity'),a=t.val(),n=D(a)?N(a,!0):O(x(a,!0));return n?(void 0!==s&&$.extend(n,{a:parseFloat(s)}),n):null;return}case'rgbString':case'rgbaString':{var e=$(this),o='rgbaString'===i;const r=$(e),c=r.val(),h=D(c)?N(c,!0):O(x(c,!0));let t=r.attr('data-opacity');return h?(void 0===t&&(t=1),o?'rgba('+h.r+', '+h.g+', '+h.b+', '+parseFloat(t)+')':'rgb('+h.r+', '+h.g+', '+h.b+')'):null;return}case'settings':return void 0===l?$(this).data('tfminicolors-settings'):($(this).each(function(){var t=$(this).data('tfminicolors-settings')||{};d($(this)),$(this).tfminicolors($.extend(!0,t,l))}),$(this));case'show':return f($(this).eq(0)),$(this);case'value':return void 0===l?$(this).val():($(this).each(function(){'object'==typeof l&&null!==l?(void 0!==l.opacity&&$(this).attr('data-opacity',I(l.opacity,0,1)),l.color&&$(this).val(l.color)):$(this).val(l),u($(this))}),$(this));default:return'create'!==i&&(l=i),$(this).each(function(){var t,i,e,o,s,r=$(this),a=l,n=$('<div class="tfminicolors" />'),c=$.tfminicolors.defaults;if(!r.data('tfminicolors-initialized')){if(a=$.extend(!0,{},c,a),n.addClass('tfminicolors-theme-'+a.theme).addClass(a.opacity?'tfminicolors-with-opacity':'tfminicolors-without-opacity'),void 0!==a.position&&$.each(a.position.split(' '),function(){n.addClass('tfminicolors-position-'+this)}),c='rgb'===a.format?a.opacity?'25':'20':a.keywords?'11':'7',r.addClass('tfminicolors-input').data('tfminicolors-initialized',!1).data('tfminicolors-settings',a).prop('size',c).attr('autocomplete','off').wrap(n).after('<div class="tfminicolors-panel tfminicolors-slider-'+a.control+"\"><div class=\"tfminicolors-slider tfminicolors-sprite\"><div class=\"tfminicolors-picker\"></div></div><div class=\"tfminicolors-opacity-slider tfminicolors-sprite\"><div class=\"tfminicolors-picker\"></div></div><div class=\"tfminicolors-grid tfminicolors-sprite\"><div class=\"tfminicolors-grid-inner tf_abs tf_w tf_h\"></div><div class=\"tfminicolors-picker\"><div></div></div></div></div>"),a.inline||r.after('<span class="tfminicolors-swatch tfminicolors-sprite tfminicolors-input-swatch"><span class="tfminicolors-swatch-color tf_abs"></span></span>'),r.on('focus.tfminicolors blur.tfminicolors keydown.tfminicolors keyup.tfminicolors paste.tfminicolors',function(t){var i=t.type;if('focus'!==i||r.parent().hasClass('tfminicolors-var-input'))if('blur'===i){const a=r.data('tfminicolors-settings');let t,i,e,o,s=r.val();if(r.data('tfminicolors-initialized')){const n=a.keywords?$.map(a.keywords.split(','),function(t){return $.trim(t.toLowerCase())}):[];o=''!==s&&(0===s.indexOf('--')||-1<$.inArray(s.toLowerCase(),n))?s:null===(i=D(s)?N(s,!0):(t=x(s,!0))?O(t):null)?a.defaultValue:'rgb'===a.format?a.opacity?N('rgba('+i.r+','+i.g+','+i.b+','+r.attr('data-opacity')+')'):N('rgb('+i.r+','+i.g+','+i.b+')'):w(i),e=a.opacity?r.attr('data-opacity'):1,'transparent'===o.toLowerCase()&&(e=0),r.closest('.tfminicolors').find('.tfminicolors-input-swatch > span').css('opacity',e),r.val(o),''===s&&r.val(E(a.defaultValue,!0)),r.val(_(s,a.letterCase))}}else if('keydown'===i)switch(t.which){case 9:p();break;case 13:case 27:p(),r.blur();break}else'keyup'!==i&&'paste'!==i||('keyup'===i?u(r,!0):setTimeout(function(){u(r,!0)},1));else f(r)}).closest('.tfminicolors').on('mousedown.tfminicolors touchstart.tfminicolors','.tfminicolors-grid, .tfminicolors-slider, .tfminicolors-opacity-slider',function(t){if(1===t.which){t.preventDefault();const i=$(this),e=document.body.contains(this)?document:top.document;m(i,t,!0),$(e).on('mousemove.tfminicolors touchmove.tfminicolors',function(t){m(i,t)}).one('mouseup.tfminicolors touchend.tfminicolors',function(){$(e).off('mousemove.tfminicolors touchmove.tfminicolors')})}}).on('click.tfminicolors','.tfminicolors-swatches li',function(t){t.preventDefault();var t=$(this),i=t.parents('.tfminicolors').find('.tfminicolors-input'),t=t.data('swatch-color');S(i,t,j(t)),u(i)}).find('.tfminicolors-input-swatch').on('click mousedown.tfminicolors touchstart.tfminicolors',function(t){if('click'===t.type)a.inline||r.focus();else{if(1!==t.which)return;f(r)}t.preventDefault()}),(c=r.parent().find('.tfminicolors-panel')).on('selectstart',function(){return!1}).end(),a.swatches&&0!==a.swatches.length)for(c.addClass('tfminicolors-with-swatches'),i=$('<ul class="tfminicolors-swatches tf_scrollbar"></ul>').appendTo(c),s=0;s<a.swatches.length;++s)e=D(o=e='object'==typeof a.swatches[s]?(t=a.swatches[s].name,a.swatches[s].color):(t='',a.swatches[s]))?N(e,!0):O(x(e,!0)),$('<li class="tfminicolors-swatch tfminicolors-sprite"><span class="tfminicolors-swatch-color tf_abs" title="'+t+'"></span></li>').appendTo(i).data('swatch-color',o).find('.tfminicolors-swatch-color').css({backgroundColor:w(e),opacity:e.a}),a.swatches[s]=e;a.inline&&r.parent().addClass('tfminicolors-inline'),u(r,!1),r.data('tfminicolors-initialized',!0)}}),$(this)}}})}(jQuery),function($,t,l){'use strict';t.themifyColorManager={colorSwatches:{},initilized:!1,init(){if(!this.initilized&&'undefined'!=typeof themifyCM){this.initilized=!0;for(let t=Object.keys(themifyCM.colors),i=0,e=t.length;i<e;++i)this.colorSwatches[t[i]]=themifyCM.colors[t[i]]}},toRgba(t){return t.color.replace('rgb','rgba').replace(')',','+t.opacity+')')},toColorsArray(){let e=[];for(let t=Object.keys(this.colorSwatches),i=t.length-1;-1<i;--i)e.push(this.toRgba(this.colorSwatches[t[i]]));return e=e.length?e:['#FFF']},initColorPicker(t){const i=t.closest('.tfminicolors').querySelector('.tfminicolors-focus .tfminicolors-panel');if(!i.getElementsByClassName('tf_swatches_container')[0]){const e=l.createElement('div'),o=e.getElementsByClassName('tfminicolors-swatch'),s=Object.keys(this.colorSwatches).reverse(),a=l.createElement('div'),n=l.createElement('span'),r=l.createElement('span'),c=l.createElement('div');e.className='tf_swatches_container',e.addEventListener('click',this.initClick.bind(this)),e.appendChild(i.getElementsByClassName('tfminicolors-swatches')[0]);for(let e=o.length-1;-1<e;--e){if(!s.length){o[e].parentNode.removeChild(o[e]);break}let t=l.createElement('span'),i=void 0!==this.colorSwatches[s[e]].uid?this.colorSwatches[s[e]].uid:this.UID()+e;t.className='tf_delete_swatch tf_close',o[e].appendChild(t),o[e].dataset.uid=this.colorSwatches[s[e]].uid=i}r.className=n.className='tf_cm_tooltip',n.innerText=themifyCM.labels.save,a.appendChild(n),a.className='tf_add_swatch tf_plus_icon',a.setAttribute('tabIndex','-1'),e.appendChild(a),r.innerText=themifyCM.labels.ie,c.appendChild(r),c.className='tf_cm_dropdown_icon',c.appendChild(this.getIcon('ti-import')),c.setAttribute('tabIndex','-1'),c.appendChild(this.makeImportExportDropdown()),e.appendChild(c),i.appendChild(e)}},makeImportExportDropdown(){const t=l.createElement('div'),i=l.createElement('ul'),e=l.createElement('li'),o=l.createElement('li');return t.className='tf_cm_dropdown',e.className='tb_cm_import',e.textContent=themifyCM.labels.import,e.appendChild(this.getIcon('ti-import')),i.appendChild(e),o.className='tb_cm_export',o.textContent=themifyCM.labels.export,o.appendChild(this.getIcon('ti-export')),i.appendChild(o),t.appendChild(i),t},getIcon(t,i){t='tf-'+t.trim().replace(' ','-');const e='http://www.w3.org/2000/svg',o=l.createElementNS(e,'use'),s=l.createElementNS(e,'svg');let a='tf_fa '+t;return i&&(a+=' '+i),s.setAttribute('class',a),o.setAttributeNS(null,'href','#'+t),s.appendChild(o),s},UID(){const t=Math.random().toString(36).substring(2)+(new Date).getTime().toString(36);return t.substring(0,5)},initClick(t){t.preventDefault();const i=t.target,e=i.classList;e.contains('tf_delete_swatch')?this.deleteSwatch(t):e.contains('tf_add_swatch')?this.addSwatch(i.ownerDocument):e.contains('tb_cm_export')?(i.parentNode.parentNode.parentNode.blur(),l.location.assign(themifyCM.exportColorsURL)):e.contains('tb_cm_import')&&(i.parentNode.parentNode.parentNode.blur(),this.importColors('colors',i.ownerDocument))},importColors(t,a){let i=(a=a||l).getElementsByClassName('themify_cm_input')[0];if(i)i.dataset.type=t;else{(i=l.createElement('input')).type='file',i.dataset.type=t,i.className='themify_cm_input';const n=this;i.addEventListener('change',function(t){const i=t.target.files[0],e=new FormData,s=t.target.dataset.type;e.append('file',i,i.name),e.append('action','themify_import_colors'),e.append('tb_load_nonce',themifyCM.nonce),e.append('type',s),$.ajax({url:themifyCM.ajax_url,type:'POST',data:e,cache:!1,dataType:'json',processData:!1,contentType:!1,success:function(t){if('SUCCESS'===t.status)if('colors'===s){n.colorSwatches=t.colors;for(let t=a.querySelectorAll('.tf_swatches_container .tfminicolors-swatch'),i=t.length-1;-1<i;--i)t[i].parentNode.removeChild(t[i]);for(let t=Object.keys(n.colorSwatches),i=t.length,e=0;e<i;e++)n.addSwatchHtml(a,n.colorSwatches[t[e]].color,n.colorSwatches[t[e]].opacity,t[e])}else if('gradients'===s){const o=ThemifyBuilderCommon.Lightbox.$lightbox.find('.tb_gradient_container').first().data('themifyGradient');for(let t=Object.keys(themifyCM.gradients),i=t.length-1;-1<i;--i)o.removeSwatch(t[i]);themifyCM.gradients=t.colors;for(let t=Object.keys(themifyCM.gradients),i=0,e=t.length;i<e;++i)o.addSwatch(themifyCM.gradients[t[i]])}alert(t.msg)}})})}i.click()},deleteSwatch(e){e.preventDefault(),e.stopPropagation();const o=e.target.parentNode.dataset.uid;for(let t=e.target.ownerDocument.querySelectorAll('[data-uid="'+o+'"]'),i=t.length-1;-1<i;--i)t[i].parentNode.removeChild(t[i]);delete this.colorSwatches[o],this.updateColorSwatches('colors')},updateColorSwatches(t){$.ajax({type:'POST',url:themifyCM.ajax_url,dataType:'json',data:{action:'themify_save_colors',type:t,tb_load_nonce:themifyCM.nonce,colors:'colors'===t?this.colorSwatches:themifyCM.gradients}})},addSwatch(t){const i=t.querySelector('.tfminicolors-focus .tfminicolors-input'),e=this.hex2Rgb(i.value),o=i.dataset.opacity;if(null===e)return!1;for(let t=Object.keys(this.colorSwatches),i=t.length-1;-1<i;--i)if(this.colorSwatches[t[i]].color.replace(/\s/g,'')===e&&parseFloat(this.colorSwatches[t[i]].opacity)===parseFloat(o))return!1;const s=this.UID();this.addSwatchHtml(t,e,o,s),this.colorSwatches[s]={color:e,opacity:o,uid:s},this.updateColorSwatches('colors')},addSwatchHtml(e,s,a,o){for(let t=e.querySelectorAll('.tf_swatches_container .tfminicolors-swatches'),i=t.length-1;-1<i;--i)t[i].insertBefore(function(t){const i=l.createElement('li'),e=l.createElement('span'),o=l.createElement('span');return i.className='tfminicolors-swatch tfminicolors-sprite',i.dataset.uid=t,i.dataset.swatchColor=s.replace(')',', '+a+')').replace('rgb','rgba'),e.className='tfminicolors-swatch-color tf_abs',e.style.backgroundColor=s,e.style.opacity=a,i.appendChild(e),o.className='tf_delete_swatch tf_close',i.appendChild(o),i}(o),t[i].firstChild)},hex2Rgb(t){const i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return i?'rgb('+parseInt(i[1],16)+','+parseInt(i[2],16)+','+parseInt(i[3],16)+')':null}},t.themifyColorManager.init()}(jQuery,window,document);